import sys, clr
import ConfigParser
from os.path import expanduser
# Set system path
home = expanduser("~")
cfgfile = open(home + "\\STVTools.ini", 'r')
config = ConfigParser.ConfigParser()
config.read(home + "\\STVTools.ini")
# Master Path
syspath1 = config.get('SysDir','MasterPackage')
sys.path.append(syspath1)
# Built Path
syspath2 = config.get('SysDir','SecondaryPackage')
sys.path.append(syspath2)

import System, Selection
import System.Threading
import System.Threading.Tasks
from Autodesk.Revit.DB import Document, FilteredElementCollector, PerformanceAdviser, Family, Transaction,\
    FailureHandlingOptions, CurveElement, BuiltInCategory, ElementId, SpatialElementTag, RevitLinkInstance, \
    RevitLinkType, View, BoundingBoxXYZ, BuiltInParameter, ViewSet, ViewSheetSet, PrintRange, ViewSheet
import re
from Autodesk.Revit.DB import Level, BuiltInParameter, WorksetTable, Element
from Autodesk.Revit.UI import TaskDialog
clr. AddReferenceByPartialName('PresentationCore')
clr.AddReferenceByPartialName('PresentationFramework')
clr.AddReferenceByPartialName('System.Windows.Forms')
import System.Windows.Forms
uidoc = __revit__.ActiveUIDocument
doc = __revit__.ActiveUIDocument.Document
from pyrevit.framework import List
from pyrevit import revit, DB
import os
from collections import defaultdict
from pyrevit import script
from pyrevit import forms
from Autodesk.Revit.UI import TaskDialog, UIApplication
from Autodesk.Revit.UI.Selection import Selection

# Find the correct dictionary
#correctDic = {}
#views = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Views).ToElements()
#for view in views:
    #if not view.IsTemplate:
        #vId = view.Id
        #vTem = view.ViewTemplateId
        #correctDic[str(vId)] = str(vTem)
#print(correctDic)

# give the correct dictionary (view Id: view template Id) and it will compare if the current dictionary matches the correct one
vTempDic = {}
n = 0
m = 0
correctDic = {'56104729': '50908923', '56709332': '50908923', '54096539': '53612244', '58172372': '55823175', '52579269': '50908923', '56556541': '54641084', '52086833': '54641084', '56593947': '54641084', '52030918': '50908923', '57722879': '50908923', '55708854': '55708852', '51961072': '-1', '56635365': '54641084', '56152379': '50908923', '2798393': '-1', '51845353': '10923664', '51843907': '57510801', '52087338': '50908923', '56182298': '50908923', '57006114': '53612246', '52631479': '50908923', '52631470': '50908923', '52631460': '50908923', '55716878': '50908923', '51658911': '50908923', '52952727': '50908923', '51658928': '50908923', '56965033': '50908923', '51995161': '50908923', '51657917': '50908923', '52673825': '50908923', '58190634': '55823175', '21491640': '50908923', '21491649': '50908923', '54437403': '50908923', '54803848': '54800599', '3449654': '40232911', '57640755': '16174897', '55215284': '55205242', '51845927': '10923664', '52101429': '54641084', '56117255': '50908923', '1922184': '53270855', '51755094': '50908923', '51999959': '50908923', '56525904': '54641084', '54144529': '53757383', '55217951': '55126354', '1299521': '2824724', '51845243': '10923664', '56067017': '10923664', '56965074': '50908923', '52090211': '50908923', '55878768': '55823175', '54981934': '-1', '51949317': '54800599', '53731804': '53612246', '52085372': '50908923', '52426628': '54800599', '53501658': '53270853', '51948735': '16174897', '52090113': '54641084', '56527994': '50908923', '58189292': '-1', '52101466': '54641084', '39572237': '39633188', '1852275': '2824724', '56536457': '50908923', '57050328': '56063763', '54439784': '53612248', '52086656': '54641084', '51843812': '57510801', '2798375': '-1', '56593956': '54641084', '51846278': '10923664', '55753318': '56180106', '51843869': '57510801', '57073424': '50908923', '52952671': '50908923', '52923679': '50908923', '51845309': '10923664', '52353767': '-1', '56171501': '50908923', '52087329': '50908923', '52087138': '50908923', '56119889': '56063831', '52087188': '50908923', '52089626': '54641084', '52089646': '54641084', '54973372': '50908923', '51658902': '50908923', '52952736': '50908923', '52674093': '50908923', '51598397': '50908923', '58237338': '55823175', '52735033': '16174897', '56635216': '54641084', '55703830': '56063831', '58238389': '55823175', '52429785': '10923664', '52425946': '54800599', '55205217': '55205242', '54569424': '54586875', '54569434': '50908923', '46924849': '39633190', '56464373': '-1', '56126798': '50908923', '51843612': '57510801', '57824820': '55823175', '52101564': '54641084', '52631375': '50908923', '52086628': '54641084', '54851857': '-1', '52923855': '50908923', '51846319': '10923664', '55062780': '53270853', '56182324': '50908923', '58189480': '55823175', '52631405': '50908923', '56116619': '50908923', '57640078': '10923664', '56116610': '50908923', '55753210': '56063831', '56116423': '50908923', '51986125': '50908923', '53474816': '53612246', '52003932': '50908923', '58125544': '55823175', '41826541': '39633188', '41826531': '39633188', '52734988': '10923664', '52735066': '-1', '52673871': '50908923', '52735056': '-1', '51755103': '50908923', '52946152': '50908923', '51949573': '54641084', '55195719': '53612246', '52579260': '50908923', '52708128': '10923664', '53754322': '53612248', '51843793': '57510801', '3449682': '40232911', '51612608': '50908923', '53873228': '-1', '54140834': '53757383', '54528056': '-1', '56581295': '54641084', '52090132': '54641084', '52685367': '-1', '3449688': '-1', '53631575': '53612244', '56590357': '-1', '56574602': '54641084', '39572246': '39713459', '55956826': '55823175', '56581130': '54641084', '55964714': '55943975', '56177722': '56063831', '56242804': '54641084', '55492994': '50908923', '58188853': '-1', '52003919': '50908923', '54851979': '-1', '54981979': '-1', '51949333': '54800599', '51598405': '50908923', '52087179': '50908923', '56299250': '-1', '52087129': '50908923', '51860409': '-1', '55711545': '16174897', '53474376': '53612246', '58238596': '55823175', '51658139': '50908923', '21231400': '54641084', '54529956': '-1', '54855725': '54800599', '52085819': '50908923', '51843688': '57510801', '51999950': '50908923', '55116790': '-1', '52924148': '50908923', '52000410': '50908923', '56625398': '54641084', '53749926': '53270853', '53483011': '53612246', '52085764': '50908923', '56542938': '53612246', '52631384': '50908923', '56536503': '50908923', '56125892': '50908923', '52631675': '50908923', '51598191': '50908923', '56116479': '50908923', '51658937': '50908923', '53684604': '53612246', '52425973': '54800599', '54007051': '53612248', '58244383': '-1', '56709323': '50908923', '22775537': '22952284', '56464367': '-1', '52086842': '54641084', '52579251': '50908923', '55753150': '56063763', '42600002': '39633190', '51844603': '10923664', '56635374': '54641084', '56152361': '50908923', '55753383': '56180106', '58072821': '53612246', '43780148': '39633188', '43780158': '39633188', '39578991': '39633188', '52631451': '50908923', '53820815': '-1', '52087024': '50908923', '51845265': '10923664', '52403623': '-1', '56242813': '54641084', '56097005': '55943975', '56242823': '54641084', '56242833': '54641084', '52003996': '50908923', '52631539': '54641084', '51053189': '-1', '52022874': '-1', '51995179': '50908923', '21491658': '50908923', '51949597': '54641084', '3449661': '40232911', '56581241': '54641084', '57760906': '50908923', '52004194': '50908923', '3449668': '40232911', '56581231': '54641084', '52101438': '54641084', '52101448': '54641084', '51846198': '10923664', '54855734': '54800599', '53561184': '53270853', '51843707': '57510801', '3427525': '40232911', '51841516': '-1', '52085838': '50908923', '54617454': '53612244', '53612237': '53612244', '56536494': '50908923', '56536484': '50908923', '55796216': '50908923', '55796206': '50908923', '51949145': '54800599', '52090229': '54641084', '54981925': '-1', '55873577': '55823175', '56536512': '50908923', '55892935': '55823175', '57054254': '56063831', '52674039': '50908923', '56886738': '-1', '58323120': '55823175', '53706818': '53706825', '51598381': '50908923', '52426600': '54800599', '55257151': '-1', '53707103': '53706825', '3427621': '40232911', '54450362': '-1', '58220579': '55823175', '56593965': '54641084', '55875977': '55823175', '52923688': '50908923', '52952662': '50908923', '55796243': '50908923', '52923658': '50908923', '52085730': '50908923', '54981970': '-1', '52631442': '50908923', '51658983': '50908923', '41910554': '39633190', '52952718': '50908923', '51949284': '54800599', '57073352': '50908923', '57073342': '50908923', '51598354': '50908923', '51755139': '50908923', '52946124': '50908923', '51845637': '10923664', '51755130': '50908923', '51948498': '10923664', '54803875': '54800599', '51949589': '54641084', '3449675': '40232911', '56581260': '54641084', '52001385': '50908923', '54447392': '56063763', '54870957': '-1', '53488419': '53270853', '51598207': '50908923', '56117227': '54641084', '51948963': '16174897', '52923814': '50908923', '54447449': '16174897', '16167146': '16167495', '54036437': '-1', '56116470': '50908923', '56116460': '50908923', '51843096': '16174897', '56965056': '50908923', '56125920': '50908923', '56125930': '50908923', '51986134': '50908923', '51845429': '10923664', '54701657': '53612246', '3450230': '-1', '54701607': '-1', '2798403': '-1', '51052434': '-1', '51949325': '54800599', '52735047': '54805073', '56745600': '53612246', '52090039': '54641084', '57006455': '56180106', '52089750': '50908923', '51947917': '-1', '54714186': '53612246', '55356412': '55388006', '55216180': '55126354', '52090141': '54641084', '57069262': '55753159', '53875164': '-1', '56581148': '54641084', '55492975': '50908923', '52430671': '54805073', '56177731': '56063831', '51949178': '54800599', '55796252': '50908923', '57073406': '50908923', '54447570': '56180106', '51949161': '54800599', '52952643': '50908923', '55715043': '-1', '56550405': '53612246', '54780970': '-1', '51845779': '10923664', '52101401': '54641084', '55983551': '55943975', '51999931': '50908923', '56152298': '50908923', '56152288': '50908923', '52000437': '50908923', '51843669': '57510801', '54959075': '-1', '51843650': '57510801', '52086665': '54641084', '51597594': '50908923', '54973417': '50908923', '57120345': '-1', '57722870': '50908923', '52101364': '54641084', '52101374': '54641084', '55316725': '53270853', '51981470': '50908923', '54973381': '50908923', '55716851': '50908923', '51597679': '50908923', '52631497': '50908923', '51598199': '50908923', '52089655': '54641084', '56116451': '50908923', '56670270': '53612246', '54437394': '50908923', '51845659': '10923664', '52004005': '50908923', '54452316': '53270855', '41779817': '39713459', '51598338': '50908923', '51657935': '50908923', '53558021': '53270853', '22775546': '22952284', '56944680': '53757383', '55942997': '-1', '56555656': '54641084', '56555666': '54641084', '52684424': '-1', '56555676': '54641084', '56555686': '54641084', '53491666': '53612248', '57761783': '50908923', '53103738': '-1', '52924249': '50908923', '56152370': '50908923', '57638958': '16174897', '55862208': '55823175', '54088243': '53270853', '57760202': '50908923', '56116414': '50908923', '56242842': '54641084', '51949308': '54800599', '51612599': '50908923', '52089715': '54641084', '52631548': '50908923', '51949341': '54800599', '52631521': '54641084', '51658860': '50908923', '51845738': '10923664', '54780552': '-1', '51658850': '50908923', '54781423': '-1', '56690012': '55126354', '52085390': '50908923', '52004185': '50908923', '56581269': '54641084', '1850896': '-1', '52101410': '54641084', '52101420': '54641084', '53668724': '53612246', '51657896': '50908923', '56152279': '50908923', '51949647': '54800599', '56085087': '55943975', '56562424': '53612246', '56528003': '50908923', '56536475': '50908923', '16551483': '-1', '51845221': '10923664', '51612554': '50908923', '51612564': '50908923', '51612574': '50908923', '51843850': '57510801', '55796225': '50908923', '53413372': '-1', '56182270': '54641084', '54981916': '-1', '1829430': '-1', '52087320': '50908923', '51949194': '54800599', '55796285': '50908923', '55161767': '55126354', '52089614': '10923664', '54420128': '50908923', '54525581': '-1', '58323101': '55823175', '52089664': '54641084', '52426637': '54800599', '38269576': '39633190', '51598389': '50908923', '22775518': '22952284', '52425964': '54800599', '22775528': '22952284', '51845820': '10923664', '54973408': '50908923', '56593974': '54641084', '56525897': '54641084', '52084072': '50908923', '52631357': '50908923', '55877254': '55823175', '56085568': '-1', '54427948': '50908923', '51871476': '-1', '52631433': '50908923', '52631423': '50908923', '52003892': '50908923', '51658974': '50908923', '52631666': '50908923', '56693506': '55126354', '57760218': '50908923', '52004203': '50908923', '52403605': '-1', '56116405': '50908923', '52683046': '-1', '51755121': '50908923', '51843481': '16174897', '56709350': '50908923', '51843441': '16174897', '52001593': '50908923', '56126781': '50908923', '51845197': '10923664', '55201680': '53612246', '54528070': '-1', '51948922': '10923664', '52923837': '50908923', '51948982': '-1', '56581099': '54641084', '56583909': '54641084', '52086728': '54641084', '54445242': '53612248', '38223335': '39633190', '55175007': '55126354', '56125901': '50908923', '56125911': '50908923', '56125948': '50908923', '56066907': '10923664', '51367918': '39713459', '52003910': '50908923', '52661904': '-1', '2798413': '-1', '52003950': '50908923', '52946180': '50908923', '58323065': '55823175', '56542161': '53612246', '58323085': '55823175', '58244872': '-1', '54460170': '-1', '21231409': '54641084', '51612617': '50908923', '52090150': '54641084', '57722911': '50908923', '44198070': '39535223', '54045418': '53270853', '56525912': '54641084', '54623218': '53612244', '56581313': '54641084', '52000419': '50908923', '56525919': '54641084', '57023846': '56063831', '54447561': '56180106', '51949170': '54800599', '53465893': '53612246', '54981952': '-1', '56536521': '50908923', '55708254': '10923664', '57043948': '56063763', '1859042': '-1', '52087197': '50908923', '54769579': '-1', '55283784': '53612246', '55780664': '56063763', '56089878': '55943975', '52631657': '50908923', '58323135': '55823175', '58151655': '55823175', '51843515': '16174897', '45135393': '-1', '56621710': '54641084', '57073389': '50908923', '51843555': '16174897', '51598362': '50908923', '57073380': '50908923', '56635255': '54641084', '54803857': '54800599', '55269184': '-1', '56709341': '50908923', '51843462': '16174897', '47844172': '39633192', '56556522': '54641084', '51843631': '57510801', '56556559': '54641084', '51597585': '50908923', '54771032': '-1', '52030900': '50908923', '53894403': '-1', '52030909': '50908923', '56987286': '56063763', '2798385': '-1', '55033888': '53612246', '56635356': '54641084', '56902897': '-1', '56152307': '50908923', '52923846': '50908923', '58298566': '58298575', '56182289': '54641084', '56298809': '-1', '16167120': '16167495', '52431205': '16174897', '52946224': '50908923', '56242770': '54641084', '56182307': '54641084', '54105106': '53270853', '54973390': '50908923', '58189686': '55823175', '51597687': '50908923', '55716860': '50908923', '52631488': '50908923', '55716869': '50908923', '52003901': '50908923', '52004014': '50908923', '52003941': '50908923', '45524133': '40232911', '51995170': '50908923', '21491631': '50908923', '51657926': '50908923', '52090057': '50908923', '56713312': '-1', '52610403': '50908923', '54803839': '54800599', '21231391': '54641084', '55269228': '53612246', '46876207': '39633190', '56828691': '-1', '51846176': '10923664', '51843750': '57510801', '54451906': '-1', '55943025': '55943975', '52086746': '54641084', '56574611': '54641084', '52610385': '50908923', '55790456': '50908923', '55790446': '50908923', '52685837': '-1', '56965065': '50908923', '52090220': '50908923', '51845405': '10923664', '56242851': '54641084', '58130372': '55823175', '52175476': '54805073', '51949300': '54800599', '54772380': '54727471', '52089706': '54641084', '55883857': '55823175', '52355879': '16174897', '57006446': '56180106', '52631530': '54641084', '57899629': '10923664', '51949581': '52005074', '57118011': '53706825', '53633808': '53612244', '52085381': '50908923', '52426619': '54800599', '51843534': '16174897', '56581278': '54641084', '56527973': '50908923', '56527953': '50908923', '53415704': '-1', '57080982': '50908923', '51982650': '16174897', '52461152': '10923664', '1852285': '2824724', '46876127': '39633190', '54770977': '-1', '56583900': '54641084', '56171491': '56180106', '56536466': '50908923', '54160998': '-1', '52086647': '54641084', '33137225': '-1', '51843888': '57510801', '51843831': '16174897', '52952699': '50908923', '2798361': '-1', '52952680': '50908923', '55796234': '50908923', '51949137': '54800599', '57328027': '-1', '57073415': '50908923', '52236954': '-1', '52087301': '50908923', '51994775': '50908923', '52087160': '54641084', '52087120': '50908923', '54972013': '10923664', '52631648': '54641084', '54973363': '50908923', '55978427': '55943975', '54973353': '50908923', '51949421': '10923664', '51598346': '50908923', '52004023': '50908923', '55060572': '53270853', '56774837': '-1', '58191663': '55823175', '51845881': '10923664', '52425955': '54800599', '56946433': '53757383', '51903006': '10923664', '52684967': '-1', '56556505': '54641084', '51992603': '50908923', '51598260': '56063831', '52084041': '50908923', '52631366': '50908923', '52101392': '54641084', '51862678': '-1', '39560612': '39633188', '52923697': '50908923', '56152342': '50908923', '52086699': '54641084', '52631396': '50908923', '52610364': '50908923', '52086737': '54641084', '56242795': '54641084', '56182333': '50908923', '52631414': '50908923', '52610394': '50908923', '56125957': '50908923', '39579001': '39633188', '2798423': '-1', '57924846': '-1', '3450216': '-1', '55982504': '55943975', '51755112': '50908923', '51658882': '50908923', '38279509': '39633190', '52001570': '50908923', '52579278': '50908923', '57824833': '55823175', '52086824': '54641084', '51598215': '50908923', '55205751': '55205242', '55987524': '55943975', '57722888': '50908923', '54761042': '-1', '51982641': '16174897', '56722858': '-1', '41886116': '39713459', '52086709': '54641084', '51845287': '10923664', '56548382': '53612246', '56066970': '57510801', '51986116': '50908923', '53418670': '-1', '54447527': '56180106', '56125939': '50908923', '57638834': '10923664', '54801031': '54800599', '55030328': '53612246', '54708117': '53612246', '1850878': '7209664', '41826499': '39713459', '52355892': '-1', '56540970': '53612246', '51843593': '57510801', '52004176': '50908923', '53476717': '53612246', '55963620': '55943975', '56119876': '56063763', '51658148': '50908923', '21231418': '54641084', '51658118': '50908923', '55847970': '55823175', '51949631': '54800599', '53101101': '-1', '51999968': '50908923', '53613193': '53612244', '56581304': '54641084', '52000428': '50908923', '57316872': '-1', '53744304': '53612248', '52030927': '50908923', '51894854': '50908923', '52101383': '54641084', '57722897': '50908923', '51061289': '-1', '51949153': '54800599', '52683714': '-1', '54447552': '56180106', '54586947': '50908923', '56066851': '57510801', '56116396': '50908923', '1859052': '-1', '56746292': '55126354', '52001624': '50908923', '54525592': '-1', '51860416': '-1', '55780685': '56063763', '57073371': '50908923', '51949292': '54800599', '53874075': '-1'}

views = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Views).ToElements()
for view in views:
    if not view.IsTemplate:
        vName = view.Name
        vId = view.Id
        vTemWrong = view.ViewTemplateId
        if str(vId) in correctDic:
            n += 1
            vTemRight = correctDic[str(vId)]
            if str(vTemWrong) != str(vTemRight):
                print(vName + ";" + str(vId) + ";" + str(vTemWrong) + ";" + str(vTemRight))
        else:
            m += 1
            pass
            #print(vName + ";" + str(vId) + ";" + str(vTemWrong) + ";" + "?")
print(n)
print(m)
print("-------------------------------------------------")
for v in views:
    if v.IsTemplate:
        tName = v.Name
        tId = v.Id
        #print(tName + ";" + str(tId))


'''
for view1 in views:
    if view1.IsTemplate:
        vTempName = view1.Name
        vTempId = view1.Id
        vTempDic[str(vTempId)] = vTempName
#print(vTempDic)
for view2 in views:
    if not view2.IsTemplate:
        vName = view2.Name
        vId = view2.Id
        vIdTemp = str(view2.ViewTemplateId)
        #print(vId)
        #print(vIdTemp)
        if not vIdTemp == "-1":
            vWrongTemp = vIdTemp
            vWrongTempName = vTempDic[vIdTemp]
            if str(vId) in correctDic:
                vRightTemp = correctDic[str(vId)]
                vRightTempName = vTempDic[vRightTemp]
                if vWrongTemp != vRightTemp:
                    print(vName + ";" + str(vId) + ";" + vWrongTempName + ";" + vWrongTemp + ";" + vRightTempName + ";" + vRightTemp)
            #print(vName + ";" + str(vId) + ";" + vTemp + ";" + vIdTemp)
            else:
                print(vName + ";" + str(vId) + ";" + vWrongTempName + ";" + vWrongTemp)
        else:
            vWrongTemp = "-1"
            vWrongTempName = "None"
            if str(vId) in correctDic:
                vRightTemp = correctDic[str(vId)]
                vRightTempName = vTempDic[vRightTemp]
                if vWrongTemp != vRightTemp:
                    print(vName + ";" + str(vId) + ";" + vWrongTempName + ";" + vWrongTemp + ";" + vRightTempName + ";" + vRightTemp)
            #print(vName + ";" + str(vId) + ";" + "None")
            else:
                print(vName + ";" + str(vId) + ";" + vWrongTempName + ";" + vWrongTemp)
'''


'''
viewsId = []
sheets = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Sheets).ToElements()
for sheet in sheets:
    viewId = sheet.GetAllPlacedViews()
    for v in viewId:
        viewId = v.ToString()
        if not viewId in viewsId:
            viewsId.append(viewId)

#print(viewsId)

toDelete = [3133, 3143]

n = 0
for t in toDelete:
    if str(t) in viewsId:
        print(t)
        n = 1
if n == 1:
    print("There is something wrong!!!")
elif n == 0:
    print("They can be deleted.")


# Delete all unused views beside parent views, primary views and view template

# List created to contain all views ElementIds
vElementIds = []
tempIds = []
pvElementIds = []
# Get all the views
views = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Views).ToElements()
# Divide the views into different groups
for view in views:
    dependency = view.LookupParameter("Dependency")
    pView = view.LookupParameter("Parent View")
    if view.IsTemplate:
        print("Template - " + view.ViewName)
    else:
        if dependency.AsString() == "Primary":
            print("Primary - " + view.ViewName)
        elif pView != None:
            parentId = pView.AsElementId()
            pvElementIds.append(parentId)
            tempIds.append(view.Id)
        else:
            tempIds.append(view.Id)
for t in tempIds:
    if t in pvElementIds:
        pass
    else:
        vElementIds.append(t)
#print(tempIds)
#print(pvElementIds)
#print(vElementIds)

#print(vElementIds)
print("-----------------------------")
#print(n)
#print("-----------------------------")

vpElementIds = []
viewports = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Viewports).ToElements()
for viewport in viewports:
    vpElementIds.append(viewport.ViewId)

delete = []
for v in vElementIds:
    if v in vpElementIds:
        pass
    else:
        delete.append(v)
        vName = doc.GetElement(v).Name
        #print(vName)
        #print("-----------------------------")

fDelete = delete[:200]
#for f in fDelete:
    #print(f)


t = Transaction(doc, 'Delete Unused Views')
t.Start()
e = 0
print("The following views are not deleted:")
for d in fDelete:
    try:
        doc.Delete(d)
        e += 1
    except:
        print(d)
print("-----------------------------")
print(str(e) + " views have been deleted.")
t.Commit()
'''
